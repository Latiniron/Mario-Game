<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ðŸš€ Star-Jet Sammler ðŸš€</title>
    <style>
        /* Allgemeines Styling fÃ¼r Spaceshuttle-Feeling */
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #0b0c10; /* Dunkler Weltraumhintergrund */
            color: #66fcf1; /* Cyber-Hellblau */
            font-family: 'Arial', sans-serif;
            user-select: none; /* Verhindert Auswahl auf Touch-GerÃ¤ten */
            overflow: hidden;
            padding: 10px;
            box-sizing: border-box;
        }

        /* Game Dashboard */
        .dashboard {
            width: 100%;
            max-width: 600px;
            padding: 15px;
            margin-bottom: 10px;
            background-color: #1f2833; /* Dunkelgrau-Blau */
            border: 2px solid #45a29e; /* Akzentfarbe */
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(69, 162, 158, 0.5); /* Leuchten */
            text-align: center;
        }

        .dashboard h1 {
            margin: 0 0 10px 0;
            color: #c5c6c7;
        }

        #gameCanvas {
            border: 3px solid #66fcf1;
            background-color: #0b0c10;
            display: block;
            touch-action: none; /* Wichtig fÃ¼r Touch-Steuerung */
            max-width: 100%; /* Passt sich der Breite des Containers an */
        }

        .controls {
            margin-top: 10px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .control-btn {
            padding: 10px 20px;
            font-size: 16px;
            font-weight: bold;
            color: #1f2833;
            background-color: #66fcf1;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
        }

        .control-btn:hover {
            background-color: #45a29e;
        }

        .control-btn:active {
            transform: scale(0.98);
        }

        /* Spezielle Klasse fÃ¼r den Pause/Weiter-Button */
        .pause-btn {
            background-color: #f6b328; /* Orange/Gelb */
            color: #1f2833;
        }
    </style>
</head>
<body>

    <div class="dashboard">
        <h1>ðŸŒŒ Star-Jet Missionszentrale ðŸŒŒ</h1>
        <div class="score-display">
            Score: <span id="score">0</span> |
            Geschw.: <span id="speedMultiplier">1.0</span>x
        </div>
        <div class="controls">
            <button class="control-btn" id="startButton">START</button>
            <button class="control-btn pause-btn" id="pauseButton" style="display: none;">PAUSE / WEITER</button>
            <button class="control-btn" id="stopButton" style="display: none;">SPIEL BEENDEN</button>
        </div>
        <p>Steuerung: **WASD / Pfeiltasten** (Desktop) oder **BerÃ¼hren** (Mobil)</p>
    </div>

    <canvas id="gameCanvas" width="600" height="400"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');
        const speedMultiplierElement = document.getElementById('speedMultiplier');
        const startButton = document.getElementById('startButton');
        const pauseButton = document.getElementById('pauseButton');
        const stopButton = document.getElementById('stopButton');

        // --- Konstanten und Variablen ---
        const INITIAL_SPEED = 3;
        const STAR_THRESHOLD = 30; // Nach 30 Sternen erhÃ¶hen
        const SPEED_INCREASE_PERCENTAGE = 0.05; // 5% ErhÃ¶hung
        const STAR_COUNT = 15; // Anzahl der gleichzeitig sichtbaren Sterne
        const JET_SIZE = 20;

        let gameLoopId;
        let isRunning = false;
        let isPaused = false;
        let score = 0;
        let collectedStars = 0;
        let currentSpeed = INITIAL_SPEED;
        let speedMultiplier = 1.0;

        let jet = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            dx: 0, // Bewegungsrichtung X
            dy: 0, // Bewegungsrichtung Y
            color: '#45a29e' // Jet-Farbe (Cyan)
        };

        let stars = [];

        // FÃ¼r Tastatursteuerung
        let keys = {};

        // --- Initialisierung und Game State Management ---

        function initGame() {
            // Passt die Canvas-GrÃ¶ÃŸe an den Viewport an (maximal 600x400)
            const ratio = 600 / 400; // SeitenverhÃ¤ltnis
            const maxWidth = window.innerWidth - 20;
            const maxHeight = window.innerHeight - 200;

            if (maxWidth / maxHeight > ratio) {
                // HÃ¶he ist der limitierende Faktor
                canvas.height = maxHeight;
                canvas.width = maxHeight * ratio;
            } else {
                // Breite ist der limitierende Faktor
                canvas.width = maxWidth;
                canvas.height = maxWidth / ratio;
            }

            jet.x = canvas.width / 2;
            jet.y = canvas.height / 2;
            score = 0;
            collectedStars = 0;
            currentSpeed = INITIAL_SPEED;
            speedMultiplier = 1.0;
            keys = {};
            stars = [];
            spawnStars(STAR_COUNT);
            updateDashboard();

            if (gameLoopId) cancelAnimationFrame(gameLoopId);
            isRunning = false;
            isPaused = false;
            startButton.style.display = 'block';
            pauseButton.style.display = 'none';
            stopButton.style.display = 'none';

            draw(); // Zeichne initial das leere Spielbrett
        }

        function startGame() {
            if (isRunning) return;
            isRunning = true;
            isPaused = false;
            startButton.style.display = 'none';
            pauseButton.style.display = 'block';
            stopButton.style.display = 'block';
            gameLoop();
        }

        function togglePause() {
            if (!isRunning) return;
            isPaused = !isPaused;
            if (!isPaused) {
                gameLoop(); // Spiel fortsetzen
            }
        }

        function stopGame() {
            if (!isRunning) return;
            isRunning = false;
            isPaused = false;
            if (gameLoopId) cancelAnimationFrame(gameLoopId);
            alert(`Game Over! Du hast ${score} Sterne gesammelt. End-Geschw.: ${speedMultiplier.toFixed(2)}x`);
            initGame();
        }

        // --- Game-Objekte Zeichnen ---

        function drawJet() {
            // Cooles Jet-Design (vereinfachte Darstellung)
            ctx.fillStyle = jet.color;
            ctx.strokeStyle = '#c5c6c7'; // Rahmenfarbe

            // HauptkÃ¶rper (Dreieck)
            ctx.beginPath();
            ctx.moveTo(jet.x, jet.y - JET_SIZE); // Spitze
            ctx.lineTo(jet.x + JET_SIZE / 2, jet.y + JET_SIZE / 2); // Rechter FlÃ¼gel
            ctx.lineTo(jet.x - JET_SIZE / 2, jet.y + JET_SIZE / 2); // Linker FlÃ¼gel
            ctx.closePath();
            ctx.fill();
            ctx.stroke();

            // Cockpit (kleiner Kreis)
            ctx.fillStyle = '#66fcf1';
            ctx.beginPath();
            ctx.arc(jet.x, jet.y - JET_SIZE / 3, JET_SIZE / 4, 0, Math.PI * 2);
            ctx.fill();
        }

        function drawStar(star) {
            // Stern-Darstellung (Gelber Kreis)
            ctx.fillStyle = '#f6b328';
            ctx.beginPath();
            ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
            ctx.fill();
        }

        function spawnStars(count) {
            for (let i = 0; i < count; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    radius: 5 + Math.random() * 3 // Leichte Variation der GrÃ¶ÃŸe
                });
            }
        }

        // --- Aktualisierungs-Logik ---

        function updateJet() {
            // Tastatur-Steuerung (Desktop)
            if (keys['w'] || keys['ArrowUp']) jet.dy = -1; else if (keys['s'] || keys['ArrowDown']) jet.dy = 1; else jet.dy = 0;
            if (keys['a'] || keys['ArrowLeft']) jet.dx = -1; else if (keys['d'] || keys['ArrowRight']) jet.dx = 1; else jet.dx = 0;

            // Bewegung anwenden
            jet.x += jet.dx * currentSpeed;
            jet.y += jet.dy * currentSpeed;

            // Begrenzung innerhalb des Canvas
            if (jet.x < 0) jet.x = 0;
            if (jet.x > canvas.width) jet.x = canvas.width;
            if (jet.y < 0) jet.y = 0;
            if (jet.y > canvas.height) jet.y = canvas.height;
        }

        function checkCollisions() {
            for (let i = 0; i < stars.length; i++) {
                const star = stars[i];
                const dx = jet.x - star.x;
                const dy = jet.y - star.y;
                const distance = Math.sqrt(dx * dx + dy * dy);

                // Kollision erkannt (Jet-KÃ¶rper trifft Stern-Radius)
                if (distance < JET_SIZE / 2 + star.radius) {
                    score++;
                    collectedStars++;

                    // Geschwindigkeitssteigerung nach Schwellwert
                    if (collectedStars % STAR_THRESHOLD === 0) {
                        speedMultiplier += SPEED_INCREASE_PERCENTAGE;
                        currentSpeed = INITIAL_SPEED * speedMultiplier;
                        console.log(`Geschw. erhÃ¶ht! Neu: ${speedMultiplier.toFixed(2)}x`);
                    }

                    // Stern entfernen und neuen spawnen
                    stars.splice(i, 1);
                    spawnStars(1);
                    updateDashboard();
                    i--; // Index korrigieren nach Entfernung
                }
            }
        }

        function updateDashboard() {
            scoreElement.textContent = score;
            speedMultiplierElement.textContent = speedMultiplier.toFixed(2);
        }

        // --- Game Loop ---

        function draw() {
            // Hintergrund leeren
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0b0c10';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Sterne zeichnen
            stars.forEach(drawStar);

            // Jet zeichnen
            drawJet();

            // Wenn das Spiel nicht lÃ¤uft, zeichne nur einmal
            if (!isRunning) {
                 ctx.fillStyle = 'rgba(11, 12, 16, 0.7)';
                 ctx.fillRect(0, 0, canvas.width, canvas.height);
                 ctx.fillStyle = '#66fcf1';
                 ctx.font = '30px Arial';
                 ctx.textAlign = 'center';
                 ctx.fillText('Star-Jet Sammler - Bereit zum Start', canvas.width / 2, canvas.height / 2);
            }
        }

        function gameLoop() {
            if (!isRunning || isPaused) return;

            updateJet();
            checkCollisions();
            draw();

            gameLoopId = requestAnimationFrame(gameLoop);
        }

        // --- Event Listener (Steuerung und Buttons) ---

        // Tastatursteuerung (Desktop)
        document.addEventListener('keydown', (e) => {
            if (isRunning) keys[e.key] = true;
        });

        document.addEventListener('keyup', (e) => {
            if (isRunning) keys[e.key] = false;
        });

        // Touch-Steuerung (Mobil)
        canvas.addEventListener('touchmove', (e) => {
            if (!isRunning || isPaused) return;
            e.preventDefault(); // Verhindert Scrollen und Zoom auf MobilgerÃ¤ten

            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            const touchX = touch.clientX - rect.left;
            const touchY = touch.clientY - rect.top;

            // Berechne die Vektoren vom Jet zum Touch-Punkt
            const dx = touchX - jet.x;
            const dy = touchY - jet.y;
            const distance = Math.sqrt(dx * dx + dy * dy);

            if (distance > 5) { // Nur bewegen, wenn nicht zu nah
                jet.dx = dx / distance;
                jet.dy = dy / distance;
            } else {
                jet.dx = 0;
                jet.dy = 0;
            }
        }, { passive: false });

        canvas.addEventListener('touchend', () => {
             // Stoppt die Bewegung, wenn der Finger vom Bildschirm genommen wird
            jet.dx = 0;
            jet.dy = 0;
        });

        // Button Listener
        startButton.addEventListener('click', startGame);
        pauseButton.addEventListener('click', togglePause);
        stopButton.addEventListener('click', stopGame);
        window.addEventListener('resize', initGame); // Passt die GrÃ¶ÃŸe bei Ã„nderung an

        // --- Spiel starten ---
        initGame();

    </script>
</body>
</html>
